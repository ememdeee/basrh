var DealerCenter;(function(e){(function(e){(function(e){var i=function(){function i(){}return i.init=function(){var e=jQuery;e(window).on("dws:compareChanged",function(){i.updateComparisionList(!1)}),i.updateComparisionList(!0),i.hookCompareVehicleButton(),null===i.compareVehicleStockNumbers&&(i.compareVehicleStockNumbers=i.loadVehiclesInComparisonList())},i.updateComparisionList=function(e){var o=jQuery,t=i.loadVehiclesInComparisonList();if(t&&t.length>0)if(e){var r=i.setValidStockNumbers(t),a=r.join(",");o.ajax({url:ajaxObject.ajaxUrl,type:"post",data:{action:"dws_vehicle_compare",stockNumbers:a},success:function(e){if(e.Vehicles&&e.Vehicles.length>0){for(var r=[],a="",n=0;n<e.Vehicles.length;n++)a=void 0!==e.Vehicles[n].DCId&&e.Vehicles[n].DCId.length>0?e.Vehicles[n].DCId+"-":"",t.indexOf(a+e.Vehicles[n].StockNumber)>=0&&r.push(a+e.Vehicles[n].StockNumber);i.saveVehiclesInComparisonList(r,"dws-compare-vehicle",!1),o(".dws-compare-vehicle-button .badge").text(r.length.toString()),o("#DWSFooterArea, body").addClass("dws-with-compare-vehicle"),0===e.Vehicles.length&&o("#DWSFooterArea, body").removeClass("dws-with-compare-vehicle")}}})}else o(".dws-compare-vehicle-button .badge").text(t.length.toString()),o("#DWSFooterArea, body").addClass("dws-with-compare-vehicle");else o("#DWSFooterArea, body").removeClass("dws-with-compare-vehicle")},i.hookCompareVehicleButton=function(){var e=jQuery;e(".dws-compare-vehicle-button").click(function(o){var t=e(o.target).data().url||"/compare-vehicle",r=i.renderCompareVehicleQueryString();""!=r&&(r="/?"+r),document.location.href=t+r})},i.removeVehicleToCompareList=function(e){var o=jQuery;if(null!==i.compareVehicleContainer&&i.compareVehicleContainer.remove(),e){var t=o("<div></div>").addClass("alert alert-info alert-dismissible fade show").css({position:"fixed",top:o("#wpadminbar").height()||0,marginLeft:"auto",marginRight:"auto",width:"100%",zIndex:1e3}).html("<strong>Compare Vehicle</strong> - Vehicle "+e+" was removed from your comparison list");o("<button></button>").attr("href","#").attr("data-bs-dismiss","alert").attr("aria-label","close").addClass("btn-close").appendTo(t),t.appendTo("body"),i.compareVehicleContainer=t,i.compareVehicleStockNumbers.indexOf(e.toString())>=0&&(i.compareVehicleStockNumbers.splice(i.compareVehicleStockNumbers.indexOf(e.toString()),1),i.saveVehiclesInComparisonList(i.compareVehicleStockNumbers)),o(window).trigger("dws:compareChanged"),setTimeout(function(){t.is(":visible")&&t.alert("close")},3e3)}},i.addVehicleToCompareList=function(e){var o=jQuery;null!==i.compareVehicleContainer&&i.compareVehicleContainer.remove();var t=o("<div></div>").addClass("alert alert-info alert-dismissible fade show").css({position:"fixed",top:o("#wpadminbar").height()||0,marginLeft:"auto",marginRight:"auto",width:"100%",zIndex:1e3}).html("<strong>Compare Vehicle</strong> - Vehicle "+e+" added to your comparison list");o("<button></button>").attr("href","#").attr("data-bs-dismiss","alert").attr("aria-label","close").addClass("btn-close").appendTo(t),t.appendTo("body"),i.compareVehicleContainer=t,i.compareVehicleStockNumbers.indexOf(e)<0&&(i.compareVehicleStockNumbers.push(String(e)),i.saveVehiclesInComparisonList(i.compareVehicleStockNumbers)),o(window).trigger("dws:compareChanged"),setTimeout(function(){t.is(":visible")&&t.alert("close")},3e3)},i.loadVehiclesInComparisonList=function(i){void 0===i&&(i="dws-compare-vehicle");var o=function(e){return"[object Array]"===Object.prototype.toString.call(e)},t=e.DWSUtils.getCookie(i),r=null;try{r=JSON.parse(t)}catch(e){}return null!==r&&o(r)||(r=[]),r},i.renderCompareVehicleQueryString=function(){var e=jQuery,i="";return this.loadVehiclesInComparisonList().length>0&&(i=e.param({stock_numbers:this.loadVehiclesInComparisonList()})),i},i.saveVehiclesInComparisonList=function(i,o,t){void 0===o&&(o="dws-compare-vehicle"),void 0===t&&(t=!0),t&&(i=i.filter(function(e){return!!e})),e.DWSUtils.setCookie(o,JSON.stringify(i))},i.setValidStockNumbers=function(e){if(!e||0==e.length)return[];for(var o=[],t=i.isStockNumberWithDcid(e),r=0;r<e.length;r++){var a=e[r];if(t){var n=a.split("-"),s=a.replace(n[0]+"-","");o.push(s)}else o.push(e[r])}return o},i.isStockNumberWithDcid=function(e){if(!e||0==e.length)return!1;for(var i=!0,o=0;o<e.length;o++)if(e[o].indexOf("-")<0){i=!1;break}return i},i.compareVehicleStockNumbers=null,i.compareVehicleContainer=null,i}();e.VehicleCompareCommon=i})(e.Plugins||(e.Plugins={}))})(e.WebSite||(e.WebSite={}))})(DealerCenter||(DealerCenter={})),jQuery(function(){DealerCenter.WebSite.Plugins.VehicleCompareCommon.init()});